<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DataTable</title>
</head>
<link rel="stylesheet" type="text/css" href="DataTable/css/dataTables.bootstrap.css" />
<link rel="stylesheet" type="text/css" href="DataTable/css/bootstrap.min.css"/>
<link href="../css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="DataTable/js/jquery.min.js"></script>
<body onload="initDataTable()">
<!--位置div-->
<div class="place">
    <span>位置：</span>
    <ul class="placeul">
        <li><a href="#">首页</a></li>
        <li><a href="#">设备列表</a></li>
    </ul>
</div>
<!--toolBar-->
<div class="rightinfo">

    <div class="tools">

        <ul class="toolbar">
            <li class="click"><img src="../images/t01.png" />添加</li>
            <li class="click"><img src="../images/t02.png" />修改</li>
            <li><img src="../images/t03.png" />删除</li>
            <li><img src="../images/t04.png" />统计</li>
            <li onclick="Export()"><img src="img/export.png" />导出</li>
        </ul>


        <ul class="toolbar1">
            <li><img src="../images/t05.png" />设置</li>
        </ul>
    </div>
    <div>
        <table class="table table-striped table-bordered table-hover datatable" id="record_list">
            <thead>
            <tr>
                <th class="table-checkbox"><input type="checkbox" class="group-checkable" data-set="#record_list .checkboxes" /></th>
                <th>设备ID</th>
                <th>设备编号</th>
                <th>设备名称</th>
                <th>设备价格</th>
                <th>设备生产公司</th>
                <th>设备所属大棚</th>
                <th>设备工作状态</th>
                <th>设备修改日期</th>
            </tr>
            </thead>
        </table>
    </div>


</div>
</body>
<script type="text/javascript" src="DataTable/js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="DataTable/js/jquery.uniform.min.js"></script>
<script type="text/javascript" src="DataTable/js/jquery.dataTables.min.js"></script>

<script>
    let result=[];
    function Export() {
        // 建议JAVA后端查询得到的JSON直接导出，而不是前端向后端传递JSON再导出
        let message = {};
        let url = "../ServletAction"
        message.Action = "exportFile";
        message.json = result.toString();
        console.log(result.toString());
        $.post(url, message, function (json) {
            if (json.ok === 200) {

            } else {
                alert("导出失败！")
            }
        });
    }
    function initDataTable(){
        init();
    }

    function init(){
        $('.datatable').dataTable({
            "paging": true,
<<<<<<< HEAD
            "searching": true,
=======
            "searching": false,
>>>>>>> e7cd7b6bd24ce9294431a1282b9c7ac8c306c4d2
            "oLanguage": {
                "aria": {
                    "sortAscending": ": activate to sort column ascending",
                    "sortDescending": ": activate to sort column descending"
                },
                "sProcessing": "处理中...",
                "sLengthMenu": "_MENU_ 记录/页",
                "sZeroRecords": "没有匹配的记录",
                "sInfo": "显示第 _START_ 至 _END_ 项记录，共 _TOTAL_ 项",
                "sInfoEmpty": "显示第 0 至 0 项记录，共 0 项",
                "sInfoFiltered": "(由 _MAX_ 项记录过滤)",
                "sInfoPostFix": "",
                "sSearch": "过滤:",
                "oPaginate": {
                    "sFirst": "首页",
                    "sPrevious": "上页",
                    "sNext": "下页",
                    "sLast": "末页"
                }
            },
            "aoColumns": [{
                "mRender": function (data, type, full) {
                    result.push(full);
                    sReturn = '<input type="checkbox" class="checkboxes" value="' + data + '"/>';
                    return sReturn;
                }, "orderable": false
            }, {
                "mRender": function (data, type, full) {
                    sReturn = "<div>"+full.deviceId+"</div>";
                    return sReturn;
                }, "orderable": false
            }, {
                "mRender": function (data, type, full) {
                    sReturn = "<div>"+full.deviceNum+"</div>";
                    return sReturn;
                }, "orderable": false
            }, {
                "mRender": function (data, type, full) {
                    sReturn = "<div>"+full.deviceName+"</div>";
                    return sReturn;
                }, "orderable": false
            }, {
                "mRender": function (data, type, full) {
                    sReturn ="<div>"+full.devicePrice+"</div>";
                    return sReturn;
                }, "orderable": false
            },{
                "mRender": function (data, type, full) {
                    sReturn = "<div>"+full.deviceCompany+"</div>";
                    return sReturn;
                }, "orderable": false
            },{
                "mRender": function (data, type, full) {
                    sReturn = "<div>"+full.deviceLocation+"</div>";
                    return sReturn;
                }, "orderable": false
            },{
                "mRender": function (data, type, full) {
                    sReturn = "<div>"+full.deviceStatus+"</div>";
                    return sReturn;
                }, "orderable": false
            },{
                "mRender": function (data, type, full) {
                    sReturn = "<div>"+full.deviceModifyTime+"</div>";
                    return sReturn;
                }, "orderable": false
            }],
            "aLengthMenu": [[5, 10, 15, 20, 25, 40, 50, -1], [5, 10, 15, 20, 25, 40, 50, "所有记录"]],
            "fnDrawCallback": function () {
                $(".checkboxes").uniform();
                $(".group-checkable").uniform();
            },
            "sAjaxSource": "../ServletAction?Action=getDeviceRecord"
        });
        $('.datatable').find('.group-checkable').change(function () {
            var set = jQuery(this).attr("data-set");
            var checked = jQuery(this).is(":checked");
            jQuery(set).each(function () {
                if (checked) {
                    $(this).attr("checked", true);
                    $(this).parents('tr').addClass("active");
                } else {
                    $(this).attr("checked", false);
                    $(this).parents('tr').removeClass("active");
                }
            });
            jQuery.uniform.update(set);
        });
        $('.datatable').on('change', 'tbody tr .checkboxes', function () {
            $(this).parents('tr').toggleClass("active");
        });
    };
</script>
</html>
